# 2장 개략적인 규모 추정
>: 보편적으로 통용되는 성능 수치상에서 사고 실험을 행하여 추정치를 계산하는 행위로서, 어떤 설계가 요구사항에 부합할 것인지 보기 위한 것 

<br>
계락적 규모 추정을 효과적으로 해 내려면 규모 확장성을 표현하는 데 필요한 기본기에 능숙해야 한다. 
(ex. 2의 제곱수, 응답지연, 고 가용성에 관계된 수치 등)

## 2의 제곱수
제대로 된 계산 결과를 얻으려면 데이터 볼륨의 단위를 **2의 제곱수로** 표현하면 어떻게 되는지 우선 알아야 한다.
<br>
최소 단위는 1바이트이고, 8비트로 구성된다. ASCII 문자하나가 차지하는 메모리 크기가 1바이트이다.

|2의 x제곱|근사치|이름|축약형|
|------|---|---|---|
|10|1천(thousand)|1킬로바이트(Kilobyte)|1KB|
|20|1백만(million)|1메가바이트(Megabyte)|1MB|
|30|10억(billion)|1기가바이트(Gigabyte)|1GB|
|40|1조(trillion)|1테라바이트(Teraobyte)|1TB|
|50|1000조(quadriliion)|1페타바이트(Petabyte)|1PB|

## 모든 프로그래머가 알아야 하는 응답지연 값 
구글의 제프 딘은 2010년에 통상적인 컴퓨터에서 구현된 연산들의 응답지연 값을 공개한 바 있다. 이들 가운데 몇몇은 더 빠른 컴퓨터가 등장하면서 더이상 유효하지 않게 되었지만, 아직도 **컴퓨터 연산 처리 속도**가 어느정도인지 짐작할 수 있도록 해준다.
![image](https://velog.velcdn.com/images/mmy789/post/f0fc2b99-b6de-478e-9f82-28fca4c2400c/image.png)
*2020년 기준으로 시각화한 수치*
![image](https://github.com/Dev-Books-Master-Study/system-design-interview/assets/87285536/580fa0e4-7acf-4eff-9f22-51c0c14c30d5)
제시된 분석하면 다음과 같은 결론이 나온다.
* 메모리는 빠르지만 디스크는 아직도 느리다.
* 디스크 탐색(seek)은 가능한 피하라.
* 단순한 압축 알고리즘은 빠르다.
* 데이터를 인터넷으로 전송하기전에 가능하면 압축하라.
* 데이터 센터는 보통 여러 지역(region)에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸린다.

## 가용성에 관계된 수치들 
>  **고가용성(high availablity)** 은 시스템이 오랜 시간 동안 지속적으로 중단없이 운영될 수 있는 능력을 지칭하는 용어다.

퍼센트로 표현을 하는데 100%는 단 한 번도 중단된 적이 없음을 의미한다.

> **SLA(Service Level Agreement)** 는 서비스 사업자(service provider)가 보편적으로 사용하는 용어로, 서비스 사업자와 고객 사이에 맺어진 합의를 의마한다.

이 합의에는 서비스 사업자가 제공하는 서비스의 가용시간이 공식적으로 기술되어 있다.

가용시간은 관습적으로 숫자 9를 사용해 표시한다. 9가 많으면 많을수록 좋다고 보면 된다.

|가용률|하루당 장애시간|주당 장애시간| 개월당 장애시간| 연간 장애시간|
|---|---|---|---|---|
|99%|14.40분|1.68시간|7.31시간|3.65일|
|99.9%|1.44분|10.08분|43.83분|8.77시간|
|99.99%|8.64초|1.01분|4.38분|52.60분|
|99.999%|964.00밀리초|6.05초|26.30초|5.26분|
|99.9999%|86.40밀리초|604.80밀리초|2.63초|31.56초|


## 에제: 트위터 QPS와 저장소 요구량 추정
다음 제시된 수치는 예시다.
**가정**
  * 월간 능동 사용자(monthly active user) 는 3억(300million)명이다.
  * 50%의 사용자가 트위터를 매일 사용한다.
  * 평균적으로 각 사용자는 매일 2건의 트윗을 올린다.
  * 미디어를 포함하는 트윗은 10% 정도다.
  * 데이터는 5년간 보관된다.
  
**추정**
QPS(Query Per Second) 추정치
* 일간 능동 사용자(Daily Active User, DAU)=3억 * 50% = 1.5억(150million)
* QPS = 1.5억 * 2트윗 / 24시간/ 3600초 = 약 3500
* 최대 QPS(Peek QPS) = 2 * QPS = 약 7000

**미디어 저장을 위한 저장소 요구량**
* 평균 트윗 크기
  * tweet_id에 64바이트
  * 텍스트에 140바이트
  * 미디어에 1MB
* 미디어 저장소 요구량: 1.5억 * 2 * 10% * 1MB = 30TB/일
* 5년간 미디어를 보관하기 위한 저장소 요구량: 30TB * 365 * 5 = 약 55PB
## 팁
개략적인 규모 추정과 관계된 면접에서 가장 중요한 것은 문제를 풀어나가는 절차다. 올바른 절차를 밟느냐가 결과를 내는 것보다 중요하다. 이에 도움될 몇 가지 팁을 공유한다.
* 근사치를 활용한 계산 ("99,987/9.1" -> "100,00/10")
* 가정(assumption)들을 적어 둬라, 나중에 살펴볼 수 있도록
* 단위(unit)을 붙여라. 모호함을 방지할 수 있다.
* 많이 출제되는 개략적 규모 추정 문제는 QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수 등을 추정하는 것. 미리 연습하자. 완벽함을 달성하는 방법은 연습뿐 !!!!